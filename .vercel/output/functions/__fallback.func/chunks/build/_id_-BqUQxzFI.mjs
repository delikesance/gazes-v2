import { u as Ae, c as lt, _ as bt } from './server.mjs';
import { defineComponent, computed, withAsyncContext, ref, watch, nextTick, unref, mergeProps, withCtx, createTextVNode, useSSRContext } from 'vue';
import { ssrRenderAttrs, ssrRenderAttr, ssrInterpolate, ssrRenderList, ssrRenderClass, ssrIncludeBooleanAttr, ssrRenderComponent, ssrRenderTeleport } from 'vue/server-renderer';
import $ from 'hls.js';
import { u } from './fetch-B1uUfs--.mjs';
import '../nitro/nitro.mjs';
import 'jsonwebtoken';
import 'bcryptjs';
import 'node:http';
import 'node:https';
import 'node:events';
import 'node:buffer';
import 'node:fs';
import 'node:path';
import 'node:crypto';
import '@supabase/supabase-js';
import '@iconify/utils';
import 'consola';
import 'node:url';
import 'ipx';
import 'vue-router';
import '@iconify/vue';
import '@vue/shared';
import './ssr-DTPz_gAB.mjs';
import './asyncData-BOLdWyFS.mjs';
import 'perfect-debounce';

const z=defineComponent({__name:"[id]",__ssrInlineRender:true,async setup(t){let p,z;const j=Ae(),C=computed(()=>String(j.params.id||"")),L=computed(()=>"1"===j.query.debug||"true"===j.query.debug),S=(...e)=>{L.value&&console.log(...e);},{data:U,error:_}=([p,z]=withAsyncContext(()=>u(`/api/anime/${C.value}`,"$loNXnfkst7")),p=await p,z(),p),R=ref("vostfr"),E=ref(null),V=ref(""),A=ref([]),q=ref(false),T=ref({vostfr:false,vf:false,va:false,var:false,vkr:false,vcn:false,vqc:false,vf1:false,vf2:false,vj:false,vo:false,raw:false,vq:false}),F=ref(false),O=computed(()=>U.value?.seasons?.filter(e=>"anime"===e.type?.toLowerCase())||[]),H=computed(()=>{const e=[],s={vostfr:"Version Originale Sous-Titr√©e Fran√ßais",vf:"Version Fran√ßaise",va:"Version Anglaise",var:"Version Arabe",vkr:"Version Cor√©enne",vcn:"Version Chinoise",vqc:"Version Qu√©b√©coise",vf1:"Version Fran√ßaise 1",vf2:"Version Fran√ßaise 2",vj:"Version Japonaise",vo:"Version Originale",raw:"Version Raw",vq:"Version Qu√©b√©coise"},a={vostfr:"üáØüáµ",vf:"üá´üá∑",va:"üá∫üá∏",var:"üá∏üá¶",vkr:"üá∞üá∑",vcn:"üá®üá≥",vqc:"üá®üá¶",vf1:"üá´üá∑",vf2:"üá´üá∑",vj:"üáØüáµ",vo:"üáØüáµ",raw:"üáØüáµ",vq:"üá®üá¶"};return Object.keys(T.value).forEach(t=>{const i=t;if(T.value[i]){const t=U.value?.languageFlags?.[i]||a[i]||"üè≥Ô∏è",l=i.toUpperCase(),o=s[i]||i.toUpperCase();e.push({code:i,label:`${t} ${l}`,fullLabel:o});}}),e}),I=ref(false),M=ref(""),N=ref(false),P=ref([]),D=ref(""),J=ref(null);let Q=null;function W(){if(Q){try{Q.destroy();}catch{}Q=null;}}return watch([I,M],async()=>{I.value?(await nextTick(),async function(){const e=J.value;var s;e&&M.value&&(S("üé¨ Setting up video with URL:",M.value),e.pause(),e.removeAttribute("src"),e.load(),s=M.value,/\.m3u8(\?.*)?$/i.test(s)&&$.isSupported()?(S("üì∫ Using HLS.js for M3U8 playback"),W(),Q=new $({enableWorker:true,debug:false,lowLatencyMode:false,backBufferLength:90}),Q.loadSource(M.value),Q.attachMedia(e),Q.on($.Events.MANIFEST_PARSED,()=>{S("‚úÖ HLS manifest parsed, starting playback"),e.play().catch(e=>{console.warn("Autoplay blocked:",e);});}),Q.on($.Events.ERROR,(e,s)=>{if(console.error("‚ùå HLS error:",s),s.fatal)switch(s.type){case $.ErrorTypes.NETWORK_ERROR:S("üîÑ Trying to recover from network error"),Q?.startLoad();break;case $.ErrorTypes.MEDIA_ERROR:S("üîÑ Trying to recover from media error"),Q?.recoverMediaError();break;default:S("üí• Fatal error, destroying HLS"),W(),D.value=`HLS playback error: ${s.details}`;}})):e.canPlayType("application/vnd.apple.mpegurl")?(S("üçé Using native HLS support"),W(),e.src=M.value,e.play().catch(e=>{console.warn("Autoplay blocked:",e);})):(S("üé• Using native video element for direct playback"),W(),e.src=M.value,e.play().catch(e=>{console.warn("Autoplay blocked:",e);})));}()):W();}),(e,t,i,l)=>{const o=lt,n=bt;unref(_)?t(`<div${ssrRenderAttrs(mergeProps({class:"muted px-5 md:px-20 section"},l))}> Failed to load anime. Try again later. </div>`):unref(U)?(t(`<div${ssrRenderAttrs(l)}><section class="section px-5 md:px-20"><div class="grid grid-cols-1 md:grid-cols-[200px,1fr] gap-6 items-start"><img${ssrRenderAttr("src",unref(U).cover)}${ssrRenderAttr("alt",unref(U).title)} class="rounded-xl border border-zinc-800 shadow-sm w-full md:w-[200px] aspect-[3/4] object-cover"><div><h1 class="mb-1">${ssrInterpolate(unref(U).title)}</h1>`),unref(U).altTitle?t(`<div class="muted"> aka ${ssrInterpolate(unref(U).altTitle)}</div>`):t("\x3c!----\x3e"),t(`<div class="divider"></div><p class="muted">${ssrInterpolate(unref(U).synopsis)}</p><div class="pills mt-2">\x3c!--[--\x3e`),ssrRenderList(unref(U).genres,e=>{t(`<span class="pill">#${ssrInterpolate(e)}</span>`);}),t('\x3c!--]--\x3e</div></div></div></section><section class="section px-5 md:px-20">'),unref(U).seasons&&0!==unref(U).seasons.length&&0!==O.value.length?(t('\x3c!--[--\x3e<div class="flex flex-wrap items-center justify-between gap-3 mb-3"><h2>Seasons</h2><div class="tabs flex flex-wrap gap-2">\x3c!--[--\x3e'),ssrRenderList(H.value,e=>{t(`<button${ssrIncludeBooleanAttr(F.value)?" disabled":""} class="${ssrRenderClass([{active:R.value===e.code,"opacity-50":F.value},"tab"])}"${ssrRenderAttr("title",e.fullLabel)}>`),F.value?t('<span class="inline-block w-3 h-3 border border-current border-t-transparent rounded-full animate-spin mr-1"></span>'):t("\x3c!----\x3e"),t(` ${ssrInterpolate(e.label)}</button>`);}),t("\x3c!--]--\x3e"),F.value&&0===H.value.length?t('<div class="text-sm text-zinc-400"> Checking languages... </div>'):t("\x3c!----\x3e"),t('</div></div><div class="mt-2"><div class="flex flex-wrap gap-2">\x3c!--[--\x3e'),ssrRenderList(O.value,e=>{t(`<button class="${ssrRenderClass([{selected:V.value===e.url},"pill pill-lg"])}">${ssrInterpolate(e.name)}</button>`);}),t('\x3c!--]--\x3e</div></div><div class="section pt-2"><h2>Episodes</h2>'),L.value?t(`<div class="bg-zinc-800 p-3 rounded mb-4 text-xs"><div><strong>Debug Info:</strong></div><div>Selected Season: ${ssrInterpolate(E.value?.name||"None")}</div><div>Selected Lang: ${ssrInterpolate(R.value)}</div><div>Episodes Count: ${ssrInterpolate(A.value.length)}</div><div>Loading: ${ssrInterpolate(q.value)}</div><div>Available Languages: ${ssrInterpolate(JSON.stringify(T.value))}</div></div>`):t("\x3c!----\x3e"),q.value?t('<div class="muted flex items-center gap-2"><div class="w-4 h-4 border-2 border-violet-600 border-t-transparent rounded-full animate-spin"></div> Loading episodes‚Ä¶ </div>'):0===A.value.length&&E.value?(t('<div class="text-center py-8">'),t(ssrRenderComponent(o,null,{},i)),t('<h4 class="font-semibold mb-2"> Aucun √©pisode disponible </h4><p class="text-zinc-400 text-sm mb-4"> Cette saison ne contient actuellement aucun √©pisode disponible. </p><div class="flex justify-center gap-2"><button class="btn ghost text-sm"> R√©essayer </button></div></div>')):A.value.length>0?(t('<div class="flex flex-wrap gap-3 mt-4">\x3c!--[--\x3e'),ssrRenderList(A.value,e=>{t(`<button class="pill pill-lg hover:border-zinc-600 text-left"${ssrRenderAttr("title",e.title||`√âpisode ${e.episode}`)}><div class="flex flex-col items-start"><span class="text-sm font-medium">${ssrInterpolate(e.title||`√âpisode ${e.episode}`)}</span>`),e.title?t("\x3c!----\x3e"):t(`<span class="text-xs opacity-70">${ssrInterpolate(E.value?.name||"Episode")}</span>`),t("</div></button>");}),t("\x3c!--]--\x3e</div>")):t("\x3c!----\x3e"),t("</div>\x3c!--]--\x3e")):(t('<div class="text-center py-16"><div class="mb-4">'),t(ssrRenderComponent(o,null,{},i)),t(`<h3 class="text-xl font-semibold mb-2">${ssrInterpolate(unref(U).manga&&unref(U).manga.length>0?"Contenu manga uniquement":"Contenu non disponible")}</h3><p class="text-zinc-400 mb-6 max-w-md mx-auto">`),unref(U).manga&&unref(U).manga.length>0?t("\x3c!--[--\x3e Ce titre n&#39;a pas d&#39;adaptation anim√©e disponible. Vous pouvez consulter la version manga/manhwa √† la place. \x3c!--]--\x3e"):t("\x3c!--[--\x3e Aucune saison ou √©pisode n&#39;est actuellement disponible pour cet anime. Il se peut que le contenu soit en cours d&#39;ajout ou temporairement indisponible. \x3c!--]--\x3e"),t('</p><div class="flex justify-center gap-3">'),unref(U).manga&&unref(U).manga.length>0&&unref(U).manga[0]?.url?t(ssrRenderComponent(n,{to:unref(U).manga[0].url,class:"btn primary"},{default:withCtx((e,s,a,t)=>{if(!s)return [createTextVNode(" Lire le manga ")];s(" Lire le manga ");}),_:1},i)):t("\x3c!----\x3e"),t(ssrRenderComponent(n,{to:"/catalogue",class:"btn secondary"},{default:withCtx((e,s,a,t)=>{if(!s)return [createTextVNode(" Retour au catalogue ")];s(" Retour au catalogue ");}),_:1},i)),t('<button class="btn ghost"> Page pr√©c√©dente </button></div></div></div>')),t("</section>"),ssrRenderTeleport(t,e=>{I.value?(e('<div class="scrim flex items-center justify-center p-4"><div class="card w-full max-w-4xl p-3"><div class="flex items-center justify-between px-2 py-1"><span class="muted">Simple player ‚Ä¢ HLS preferred</span><button class="btn secondary"> Close ‚úñÔ∏è </button></div>'),N.value?e('<div class="muted p-2 text-center"><div class="w-6 h-6 border-2 border-violet-600 border-t-transparent rounded-full animate-spin mx-auto mb-2"></div> Resolving media‚Ä¶ üß≠ </div>'):e("\x3c!----\x3e"),!N.value&&M.value?e('<video controls autoplay preload="metadata" class="w-full rounded-lg border border-zinc-800" controlsList="nodownload" disablePictureInPicture></video>'):N.value?e("\x3c!----\x3e"):(e('<div class="muted text-center py-8"><div class="mb-4">'),e(ssrRenderComponent(o,null,{},i)),e('<h4 class="font-semibold mb-2"> Aucun flux vid√©o trouv√© </h4><p class="text-zinc-400 text-sm mb-4"> Impossible d&#39;extraire le lien vid√©o direct de cette source. Essayez un autre √©pisode ou une autre source. </p>'),D.value?e(`<div class="text-rose-400 text-sm mt-2">${ssrInterpolate(D.value)}</div>`):e("\x3c!----\x3e"),e("</div></div>")),P.value.length?(e('<div class="flex flex-wrap gap-2 p-2 overflow-auto">\x3c!--[--\x3e'),ssrRenderList(P.value,s=>{e(`<button class="btn ghost text-sm">${ssrInterpolate(s.type.toUpperCase())}${ssrInterpolate(s.quality?` ${s.quality}`:"")} üîó </button>`);}),e("\x3c!--]--\x3e</div>")):e("\x3c!----\x3e"),e("</div></div>")):e("\x3c!----\x3e");},"body",false,i),t("</div>")):t(`<div${ssrRenderAttrs(mergeProps({class:"muted px-5 md:px-20 section"},l))}>Loading‚Ä¶</div>`);}}}),j=z.setup;z.setup=(e,s)=>{const a=useSSRContext();return (a.modules||(a.modules=new Set)).add("pages/anime/[id].vue"),j?j(e,s):void 0};

export { z as default };
//# sourceMappingURL=_id_-BqUQxzFI.mjs.map
