import{d as e,r as s,o as t,c as a,a as l,w as r,b as i,F as n,e as o,f as c,n as u,g as d,h as m,_ as p,t as v,i as g,u as h,j as f,k as x,l as b,m as y,p as w,q as z,s as k,S as j,v as $}from"#entry";import{u as _,C}from"./IxaEYVKU.js";import{_ as q,H as F,C as S}from"./BZbZ_eK-.js";import{u as A}from"./DX0gWob3.js";import"./BYGDUgx8.js";import"./BAP8KhUJ.js";const I={key:0,class:"flex gap-5 overflow-x-auto scroll-smooth snap-x snap-mandatory pl-5 md:pl-20 pr-5 md:pr-20 scroll-pl-5 md:scroll-pl-20 scroll-pr-5 md:scroll-pr-20"},P={key:1,class:"flex items-center justify-center h-32 text-zinc-400"},R={key:2,class:"flex gap-5 overflow-x-auto scroll-smooth snap-x snap-mandatory pl-5 md:pl-20 pr-5 md:pr-20 scroll-pl-5 md:scroll-pl-20 scroll-pr-5 md:scroll-pr-20"},D=["onClick"],E={class:"h-[240px] relative overflow-hidden"},L=["src","alt"],G={class:"absolute bottom-0 left-0 right-0 h-1 bg-zinc-600"},M={class:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors duration-300 flex items-center justify-center"},W={class:"opacity-0 group-hover:opacity-100 transition-opacity duration-300"},H={class:"min-h-[80px] p-3 bg-zinc-900 flex flex-col justify-between"},O={class:"font-medium text-white text-sm mb-1 group-hover:text-violet-400 transition-colors"},B={class:"text-zinc-400 text-xs mb-1"},T={class:"text-zinc-500 text-xs"},J=e({__name:"ContinueWatchingRow",setup(e){const h=s([]),f=s(!0),x=s(""),b=e=>e.image||"/placeholder-poster.jpg",y=e=>{if(e.toLowerCase().startsWith("saison")){const s=e.match(/saison(\d+)/i);if(s)return`Saison ${s[1]}`}return e};return t(()=>{(async()=>{try{f.value=!0;const s=await $fetch("/api/watch/progress");if(s.success){const t=[...new Set(s.progress.map(e=>e.animeId))],a=new Map;for(const s of t)try{const e=await $fetch(`/api/anime/${s}`);if(e?.title&&e?.cover){const t=e.languageFlags?Object.keys(e.languageFlags)[0]:"vostfr";a.set(s,{title:e.title,cover:e.cover,defaultLang:t||"vostfr"})}}catch(e){console.warn(`Failed to fetch anime data for ${s}:`,e)}h.value=s.progress.map(e=>{const s=a.get(e.animeId);return{...e,progressPercent:e.duration>0?e.currentTime/e.duration*100:0,title:s?.title||e.animeId,image:s?.cover||"",defaultLang:s?.defaultLang||"vostfr"}})}else x.value="Failed to load continue watching items"}catch(e){console.error("Failed to load continue watching:",e),x.value="Failed to load continue watching items"}finally{f.value=!1}})()}),(e,s)=>{const t=p,x=q;return l(),a(x,{title:"Continuer à regarder"},{default:r(()=>[f.value?(l(),i("div",I,[(l(),i(n,null,o(8,e=>c("div",{key:e,class:"snap-start shrink-0 rounded-xl border border-zinc-800 bg-zinc-900/40 animate-pulse w-[200px] min-h-[320px]"})),64))])):0===h.value.length?(l(),i("div",P,[...s[0]||(s[0]=[c("p",null,"Aucun contenu en cours",-1)])])):(l(),i("div",R,[(l(!0),i(n,null,o(h.value,e=>{return l(),i("div",{key:`${e.animeId}-${e.season}-${e.episode}`,class:"snap-start shrink-0 group relative rounded-xl overflow-hidden border border-zinc-800 hover:border-zinc-600 transition-all duration-300 w-[200px] min-h-[320px] flex flex-col cursor-pointer",onClick:s=>(e=>{const s=e.defaultLang||"vostfr";g(`/watch/${e.animeId}/${e.season}/${s}/${e.episode}?continue=true`)})(e)},[c("div",E,[c("img",{src:b(e),alt:`Poster for ${e.title||e.animeId}`,class:"w-[200px] h-[240px] object-cover group-hover:scale-105 transition-transform duration-300"},null,8,L),c("div",G,[c("div",{class:d(["h-full transition-all duration-300",(s=e.progressPercent,s>=90?"bg-green-500":s>=50?"bg-yellow-500":"bg-blue-500")]),style:u({width:e.progressPercent+"%"})},null,6)]),c("div",M,[c("div",W,[m(t,{name:"heroicons:play",class:"w-12 h-12 text-white drop-shadow-lg"})])])]),c("div",H,[c("div",null,[c("h4",O,v(e.title||e.animeId),1),c("p",B,v(y(e.season))+" • Épisode "+v(e.episode),1),c("p",T,v(Math.round(e.progressPercent))+"% vu ",1)])])],8,D);var s}),128))]))]),_:1})}}}),K=Object.assign(J,{__name:"ContinueWatchingRow"}),N={key:0,class:"section px-5 md:px-20"},Q={class:"flex items-center justify-between mb-6"},U={class:"text-2xl font-bold mb-2"},V={class:"flex items-center gap-4"},X={key:0,class:"flex items-center gap-2 text-sm text-zinc-400"},Y={class:"min-h-[400px]"},Z={key:0,class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4"},ee={key:1,class:"text-center py-16"},se={class:"mb-4"},te={class:"text-zinc-400 mb-4"},ae={key:2,class:"text-center py-16"},le={class:"mb-4"},re={class:"text-zinc-400 mb-4"},ie={class:"flex justify-center gap-3"},ne={key:3,class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4"},oe={key:1},ce={class:"relative"},ue={key:0,class:"h-[60vh] md:h-[80vh] lg:h-[90vh] bg-gradient-to-br from-violet-900/20 via-zinc-900 to-zinc-950 flex items-center justify-center"},de={class:"section"},me={class:"relative"},pe={class:"flex gap-5 overflow-x-auto scroll-smooth snap-x snap-mandatory pl-20 pr-20 scroll-pl-20 scroll-pr-20"},ve={class:"flex flex-col gap-10 mt-10"},ge={class:"py-8"},he={class:"mb-6 flex items-center justify-between px-4 md:px-20"},fe={class:"text-xl font-semibold text-white"},xe={class:"relative"},be={class:"flex gap-4 overflow-x-auto scroll-smooth px-4 md:px-20"},ye={class:"section px-5 md:px-20 mt-16"},we={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ze={class:"w-16 h-16 mx-auto mb-4 rounded-full bg-violet-700/20 flex items-center justify-center group-hover:bg-violet-700/30 transition-colors"},ke={class:"w-16 h-16 mx-auto mb-4 rounded-full bg-emerald-700/20 flex items-center justify-center group-hover:bg-emerald-700/30 transition-colors"},je=$(e({__name:"index",setup(e){_({title:"Accueil - Gazes",description:"Découvrez le meilleur de l'animation japonaise et mondiale"});const u=h(),d=f(),g=s(null),$=s(null),q=s(!1),I=["Action","Aventure","Comédie","Drame","Fantastique","Horreur","Romance","Science-Fiction","Sport"],{query:P,search:R,executeSearch:D,clearSearch:E}=A(async e=>{const s=await $fetch("/api/catalogue",{params:{search:e}});return s?.items||[]},{debounceMs:300,minLength:2}),L=String(u.query.q||"");L&&(P.value=L),x(()=>u.query.q,e=>{const s=String(e||"");s!==P.value&&(P.value=s)}),x(P,e=>{e!==String(u.query.q||"")&&d.replace({query:e?{q:e}:{}})});const G=async e=>{try{const s=await $fetch(`/api/anime/${e}`);$.value=s}catch(s){console.error("Failed to fetch hero details:",s),$.value=null}},M=b(()=>!!P.value&&P.value.trim().length>=2),W=b(()=>($.value?.genres?.filter(Boolean)||[]).slice(0,3).join(" • ")),H=b(()=>R.loading.value?"Recherche en cours...":R.error.value?"Erreur de recherche":R.isEmpty.value?"Aucun résultat":`Résultats pour "${P.value}"`);t(()=>{M.value||(async()=>{if(!g.value){q.value=!0;try{const e=await $fetch("/api/catalogue",{params:{limit:1}}),s=e?.items?.[0];s?(g.value=s,await G(s.id)):(g.value={id:"error",title:"Gazes",image:""},$.value={synopsis:"Découvrez le meilleur de l'animation japonaise et mondiale",genres:["Animation"]})}catch(e){console.error("Failed to fetch hero content:",e),g.value={id:"error",title:"Gazes",image:""},$.value={synopsis:"Découvrez le meilleur de l'animation japonaise et mondiale",genres:["Animation"]}}finally{q.value=!1}}})()});const O=()=>{E(),d.replace({query:{}})},B=()=>{P.value&&D(P.value)};return(e,s)=>{const t=p,u=k,d=C;return l(),i("div",null,[M.value?(l(),i("section",N,[c("div",Q,[c("div",null,[c("h1",U,v(H.value),1),c("div",V,[c("button",{onClick:O,class:"btn ghost text-sm"}," ← Retour à l'accueil "),w(R).loading.value?(l(),i("div",X,[...s[0]||(s[0]=[c("div",{class:"w-4 h-4 border-2 border-violet-600 border-t-transparent rounded-full animate-spin"},null,-1),z(" Recherche... ",-1)])])):y("",!0)])])]),c("div",Y,[w(R).loading.value?(l(),i("div",Z,[(l(),i(n,null,o(12,e=>c("div",{key:e,class:"w-40 overflow-hidden rounded-lg border border-zinc-800 bg-zinc-900/50 animate-pulse"},[...s[1]||(s[1]=[c("div",{class:"aspect-[3/4] bg-zinc-800"},null,-1),c("div",{class:"p-3"},[c("div",{class:"h-4 bg-zinc-800 rounded mb-2"}),c("div",{class:"h-4 bg-zinc-800 rounded w-3/4"})],-1)])])),64))])):w(R).error.value?(l(),i("div",ee,[c("div",se,[m(t,{name:"heroicons:exclamation-triangle",class:"w-16 h-16 text-amber-500 mx-auto mb-4"}),s[2]||(s[2]=c("h3",{class:"text-xl font-semibold mb-2"}," Erreur de recherche ",-1)),c("p",te,v(w(R).error.value),1),c("button",{onClick:B,class:"btn primary"}," Réessayer ")])])):w(R).isEmpty.value?(l(),i("div",ae,[c("div",le,[m(t,{name:"heroicons:magnifying-glass",class:"w-16 h-16 text-zinc-500 mx-auto mb-4"}),s[4]||(s[4]=c("h3",{class:"text-xl font-semibold mb-2"}," Aucun résultat ",-1)),c("p",re,' Aucun contenu trouvé pour "'+v(w(P))+'" ',1),c("div",ie,[c("button",{onClick:O,class:"btn secondary"}," Effacer la recherche "),m(u,{to:"/catalogue",class:"btn primary"},{default:r(()=>[...s[3]||(s[3]=[z(" Parcourir le catalogue ",-1)])]),_:1})])])])):(l(),i("div",ne,[(l(!0),i(n,null,o(w(R).results.value,e=>(l(),a(d,{key:e.id,to:`/anime/${e.id}`,src:e.image,title:e.title,size:"sm"},null,8,["to","src","title"]))),128))]))])])):(l(),i("section",oe,[c("div",ce,[!q.value&&g.value&&$.value?(l(),a(F,{key:1,title:g.value.title,subtitle:W.value,image:$.value.banner||g.value.image,"primary-to":`/anime/${g.value.id}`,"secondary-to":`/anime/${g.value.id}`,synopsis:$.value.synopsis},null,8,["title","subtitle","image","primary-to","secondary-to","synopsis"])):(l(),i("div",ue,[...s[5]||(s[5]=[c("div",{class:"text-center"},[c("div",{class:"w-16 h-16 border-4 border-violet-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),c("h2",{class:"text-xl font-semibold mb-2"},"Chargement..."),c("p",{class:"text-zinc-400"},"Préparation du contenu")],-1)])]))]),(l(),a(j,null,{fallback:r(()=>[c("section",de,[s[6]||(s[6]=c("div",{class:"flex justify-between items-center mb-4 px-20"},[c("h3",{class:"row-title"},"Continuer à regarder")],-1)),c("div",me,[c("div",pe,[(l(),i(n,null,o(8,e=>c("div",{key:e,class:"snap-start shrink-0 rounded-xl border border-zinc-800 bg-zinc-900/40 animate-pulse aspect-[9/12] w-[170px]"})),64))])])])]),default:r(()=>[m(K,{title:"Continuer à regarder","max-items":20})]),_:1})),c("div",ve,[(l(),i(n,null,o(I,e=>c("div",{key:e},[(l(),a(j,null,{fallback:r(()=>[c("section",ge,[c("div",he,[c("h3",fe,v(e),1)]),c("div",xe,[s[8]||(s[8]=c("div",{class:"pointer-events-none absolute inset-y-0 left-0 z-10 w-20 bg-gradient-to-r from-zinc-950 to-transparent"},null,-1)),s[9]||(s[9]=c("div",{class:"pointer-events-none absolute inset-y-0 right-0 z-10 w-20 bg-gradient-to-l from-zinc-950 to-transparent"},null,-1)),c("div",be,[(l(),i(n,null,o(8,e=>c("div",{key:e,class:"flex-shrink-0 w-40"},[...s[7]||(s[7]=[c("div",{class:"aspect-[3/4] rounded-lg bg-zinc-800 animate-pulse"},null,-1),c("div",{class:"mt-3 p-3"},[c("div",{class:"h-4 bg-zinc-800 rounded mb-2"}),c("div",{class:"h-4 bg-zinc-800 rounded w-3/4"})],-1)])])),64))])])])]),default:r(()=>[m(S,{title:e,genre:e,"card-size":"sm"},null,8,["title","genre"])]),_:2},1024))])),64))]),c("section",ye,[s[14]||(s[14]=c("div",{class:"text-center mb-8"},[c("h2",null,"Découvrez plus de contenus"),c("p",{class:"muted"},"Explorez nos différentes catégories")],-1)),c("div",we,[m(u,{to:"/series",class:"card p-6 text-center group hover:border-zinc-600 transition-colors"},{default:r(()=>[c("div",ze,[m(t,{name:"heroicons:tv",class:"w-8 h-8 text-violet-400"})]),s[10]||(s[10]=c("h3",{class:"mb-2"},"Séries",-1)),s[11]||(s[11]=c("p",{class:"muted text-sm"}," Plongez dans des histoires captivantes ",-1))]),_:1}),m(u,{to:"/movies",class:"card p-6 text-center group hover:border-zinc-600 transition-colors"},{default:r(()=>[c("div",ke,[m(t,{name:"heroicons:film",class:"w-8 h-8 text-emerald-400"})]),s[12]||(s[12]=c("h3",{class:"mb-2"},"Films",-1)),s[13]||(s[13]=c("p",{class:"muted text-sm"}," Des chefs-d'œuvre cinématographiques ",-1))]),_:1})])])]))])}}}),[["__scopeId","data-v-15a407e0"]]);export{je as default};
