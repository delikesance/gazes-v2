const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DhaPZuqS.js","./BX6aoW9r.js","./video-js.C7gZ0GHR.css"])))=>i.map(i=>d[i]);
import{d as e,u as t,r as a,l,G as o,k as n,o as s,H as i,b as r,f as u,m as c,h as v,w as d,t as p,g as m,B as f,F as h,e as g,n as b,i as y,_ as w,s as x,ae as k,a as $,c as L,v as C}from"#entry";import{f as S}from"./BuarnCA1.js";const T=[{hostname:"video.sibnet.ru",reliability:10,description:"SibNet - Reliable MP4 URLs with relative path extraction",extractionPatterns:["MP4 relative paths in JavaScript"],knownIssues:["Requires relative-to-absolute URL conversion"]},{hostname:"streamtape.com",reliability:8,description:"StreamTape - Good MP4 extraction",extractionPatterns:["MP4 via JavaScript variables"],knownIssues:["Sometimes requires referer header"]},{hostname:"vidmoly.to",reliability:7,description:"Vidmoly - Standard video hosting with good extraction",extractionPatterns:["MP4/M3U8 in script tags"],knownIssues:[]},{hostname:"uqload.com",reliability:5,description:"UQLoad - Standard extraction patterns",extractionPatterns:["MP4 in JavaScript"],knownIssues:["Variable extraction success"]},{hostname:"doodstream.com",reliability:4,description:"DoodStream - Medium reliability",extractionPatterns:["Obfuscated JavaScript"],knownIssues:["Often requires token-based access"]},{hostname:"www.myvi.tv",reliability:3,description:"MyVi - Requires advanced JavaScript extraction",extractionPatterns:["Dynamic JavaScript loading"],knownIssues:["Complex obfuscation","Anti-bot protection"]},{hostname:"sendvid.com",reliability:1,description:"SendVid - Frequently returns 404 errors",extractionPatterns:["MP4 direct links in HTML"],knownIssues:["Many URLs returning 404 Not Found","Poor reliability"]}];function E(e){try{const t=new URL(e).hostname.toLowerCase();return T.find(e=>t===e.hostname||t.includes(e.hostname.split(".")[0]||"")||e.hostname.includes(t.split(".").slice(-2).join(".")))||null}catch{return null}}const U=globalThis.setInterval,z={class:"bg-gradient-to-b from-black/80 via-black/40 to-transparent p-4 md:p-6"},V={class:"flex items-center justify-between text-white"},P={class:"flex items-center gap-4"},R={class:"flex flex-col"},M={class:"text-base font-medium text-white"},j={class:"text-sm text-zinc-300"},A={class:"flex items-center gap-2"},F={key:0,class:"mt-3 px-4 py-2 bg-amber-600/90 rounded-lg text-amber-100 text-sm"},I={class:"flex-1 relative bg-black min-h-0"},q={key:0,class:"absolute inset-0 flex items-center justify-center text-white"},D={key:1,class:"absolute inset-0 flex items-center justify-center text-white"},N={class:"text-center max-w-md px-6"},_={class:"text-zinc-300 mb-6"},K={key:0,class:"absolute inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-30"},B={class:"flex items-center justify-between p-4 border-b border-zinc-700"},J={class:"text-zinc-400 text-sm"},O={class:"max-h-80 overflow-y-auto custom-scrollbar"},H={key:0,class:"p-6 text-center text-zinc-400"},Q={key:1,class:"p-6 text-center text-zinc-400"},G={key:2,class:"divide-y divide-zinc-800"},W=["onClick"],X={class:"flex-shrink-0 w-20 h-12 bg-zinc-800 rounded-md overflow-hidden flex items-center justify-center relative group-hover:bg-zinc-700 transition-colors"},Y={class:"text-white font-bold text-lg"},Z={key:0,class:"absolute inset-0 bg-violet-600/20 flex items-center justify-center"},ee={key:1,class:"absolute inset-0 bg-black/0 group-hover:bg-black/30 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-all"},te={class:"flex-1 min-w-0"},ae={class:"flex items-center gap-2 mb-1"},le={class:"text-white font-medium text-base"},oe={key:0,class:"text-xs bg-violet-600 text-white px-2 py-1 rounded-full font-medium"},ne={class:"text-zinc-400 text-sm"},se={class:"flex-shrink-0 opacity-0 group-hover:opacity-100 transition-opacity"},ie={class:"bg-gradient-to-t from-black/90 via-black/60 to-transparent px-4 pb-4 pt-8 md:px-6 md:pb-6 pointer-events-auto"},re={class:"mb-3"},ue={key:0,class:"absolute inset-0 bg-blue-500/20 rounded-full flex items-center justify-center"},ce={class:"flex items-center justify-between text-white"},ve={class:"flex items-center gap-3"},de={class:"w-16 h-1 bg-white/20 rounded-full relative group"},pe=["value"],me={class:"text-sm text-zinc-300 whitespace-nowrap"},fe={class:"flex items-center gap-2"},he={key:0,class:"relative"},ge=["disabled"],be={key:0,class:"inline-block w-3 h-3 border border-current border-t-transparent rounded-full animate-spin"},ye={key:1},we={class:"py-1"},xe=["onClick","disabled"],ke={class:"text-xs opacity-75 flex-1"},$e=["title"],Le={key:1,class:"p-2 hover:bg-white/10 rounded-full transition-colors",title:"Sources"},Ce={key:2,class:"absolute inset-0 bg-black/80 flex items-center justify-center z-40"},Se={class:"text-center text-white max-w-md px-6"},Te={class:"text-lg font-medium mb-2"},Ee={class:"text-sm text-zinc-400 mb-4 break-all"},Ue={class:"flex flex-wrap gap-2 justify-center"},ze={key:3,class:"absolute bottom-24 left-4 right-4 bg-black/90 border border-zinc-700 rounded-lg p-4 text-white text-sm z-30 max-h-32 overflow-y-auto"},Ve={class:"space-y-1"},Pe={class:"font-mono text-xs truncate flex-1"},Re=["onClick"],Me={class:"mt-2 pt-2 border-t border-zinc-600"},je={class:"text-xs text-zinc-400"},Ae={key:4,class:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-40 transition-opacity duration-300"},Fe={class:"bg-black/80 backdrop-blur-sm rounded-lg p-4 text-center text-white"},Ie={class:"text-sm text-zinc-300 mb-2"},qe=18e5,De=C(e({__name:"[episode]",setup(e){let C=null,T=null;const De=t(),Ne=a(De.params.id),_e=a(De.params.season),Ke=a(De.params.lang),Be=a(Number(De.params.episode)),Je=l(()=>"1"===De.query.debug||"true"===De.query.debug),Oe=l(()=>"true"===De.query.continue),He=a(!0),Qe=a(""),Ge=a(0),We=a(!1),Xe=a(""),Ye=a([]),Ze=a(""),et=a(null),tt=a(""),at=a(!1),lt=a(!1),ot=a(0),nt=a(0),st=a(1),it=a(!1),rt=a(!1),ut=a(!0),ct=a(null),vt=a(!1),dt=a(0),pt=a(!1),mt=a(!1);let ft=null,ht=0;function gt(){const e=Date.now();if(e-ht<100)return void(ft=requestAnimationFrame(gt));const t=et.value;if(t&&!t.paused&&!t.ended){const a=t.currentTime,l=t.buffered.length>0?t.buffered.end(t.buffered.length-1):0;Math.abs(a-ot.value)>.1&&(ot.value=a),Math.abs(l-dt.value)>.5&&(dt.value=l),ht=e,ft=requestAnimationFrame(gt)}}function bt(){ft&&(cancelAnimationFrame(ft),ft=null)}const yt=a(!1),wt=a([]),xt=a(!1),kt=a({}),$t=a({}),Lt=a({}),Ct=a({});function St(e,t,a,l){return`${e}-${t}-${a}-${l}`}function Tt(e){const t=kt.value[e];return t&&Date.now()-t.timestamp<qe?(t.accessCount++,console.log("🎯 Using cached URLs for:",e,`(accessed ${t.accessCount} times)`),t.urls):null}function Et(e,t){const a=Object.entries(kt.value);if(a.length>=20){const e=a.reduce((e,[t,a])=>a.accessCount<e.accessCount||a.accessCount===e.accessCount&&a.timestamp<e.timestamp?{key:t,...a}:e,{key:"",accessCount:1/0,timestamp:1/0});e.key&&(delete kt.value[e.key],console.log("🗑️ Evicted cache entry:",e.key))}kt.value[e]={urls:t,timestamp:Date.now(),accessCount:1},console.log("💾 Cached URLs for:",e)}function Ut(){try{sessionStorage.setItem("video-url-cache",JSON.stringify(kt.value))}catch(e){console.warn("Failed to save URL cache:",e)}}const zt=a(null),Vt=a(null),Pt=a(0),Rt=a({vostfr:!1,vf:!1,va:!1,var:!1,vkr:!1,vcn:!1,vqc:!1,vf1:!1,vf2:!1,vj:!1}),Mt=a(!1),jt=a(!1),At=l(()=>{const e=[];if(Rt.value.vostfr){const t=_t.value.vostfr||"��🇳";e.push({code:"vostfr",label:`${t} VOSTFR`,fullLabel:"Version Originale Sous-Titrée Français"})}if(Rt.value.vf){const t=_t.value.vf||"🇫🇷";e.push({code:"vf",label:`${t} VF`,fullLabel:"Version Française"})}if(Rt.value.va){const t=_t.value.va||"🇺🇸";e.push({code:"va",label:`${t} VA`,fullLabel:"Version Anglaise"})}if(Rt.value.var){const t=_t.value.var||"🇸🇦";e.push({code:"var",label:`${t} VAR`,fullLabel:"Version Arabe"})}if(Rt.value.vkr){const t=_t.value.vkr||"🇰🇷";e.push({code:"vkr",label:`${t} VKR`,fullLabel:"Version Coréenne"})}if(Rt.value.vcn){const t=_t.value.vcn||"🇨🇳";e.push({code:"vcn",label:`${t} VCN`,fullLabel:"Version Chinoise"})}if(Rt.value.vqc){const t=_t.value.vqc||"🇨🇦";e.push({code:"vqc",label:`${t} VQC`,fullLabel:"Version Québécoise"})}if(Rt.value.vf1){const t=_t.value.vf1||"🇫🇷";e.push({code:"vf1",label:`${t} VF1`,fullLabel:"Version Française 1"})}if(Rt.value.vf2){const t=_t.value.vf2||"🇫🇷";e.push({code:"vf2",label:`${t} VF2`,fullLabel:"Version Française 2"})}if(Rt.value.vj){const t=_t.value.vj||"🇯🇵";e.push({code:"vj",label:`${t} VJ`,fullLabel:"Version Japonaise"})}return e}),Ft=l(()=>At.value.find(e=>e.code===Ke.value)||{label:Ke.value.toUpperCase(),fullLabel:Ke.value.toUpperCase()}),It=l(()=>S(_e.value)),qt=l(()=>`Épisode ${Be.value.toString().padStart(2,"0")}`),Dt=a(""),Nt=a(""),_t=a({}),Kt=a([]),Bt=a(!0),Jt=a(!1),Ot=a(null),Ht=a(null);async function Qt(){try{const e=await $fetch(`/api/watch/progress/${Ne.value}`);if(e?.success&&"progress"in e){const t=Array.isArray(e.progress)?e.progress:[e.progress];if(t.length>0){const e=t.find(e=>e.season===_e.value&&e.episode===Be.value);e&&!e.completed&&(zt.value={currentTime:e.currentTime,duration:e.duration},console.log("📺 Loaded saved progress:",zt.value))}}}catch(e){console.warn("Failed to load saved progress:",e)}}async function Gt(e,t){if(t<10)return;const a=Date.now();if(!(a-Pt.value<5e3))try{await $fetch(`/api/watch/progress/${Ne.value}`,{method:"POST",body:{season:_e.value,episode:Be.value,currentTime:e,duration:t}}),Pt.value=a,console.log("💾 Progress saved:",{currentTime:e,duration:t})}catch(l){console.warn("Failed to save progress:",l)}}const Wt=l(()=>nt.value>0?ot.value/nt.value*100:0),Xt=l(()=>nt.value>0?dt.value/nt.value*100:0);let Yt=null;function Zt(e){return/\.m3u8(\?.*)?$/i.test(e)}let ea=null;function ta(){try{Yt&&(ea&&(clearTimeout(ea),ea=null),Pa&&(clearTimeout(Pa),Pa=null),Yt.dispose())}catch(e){console.warn("Error destroying player:",e)}Yt=null,bt(),La(et.value)}function aa(){if(Yt)lt.value?Yt.pause():Yt.play().catch(e=>{console.log("Play failed:",e)});else{const e=et.value;if(!e)return;lt.value?e.pause():e.play().catch(e=>{console.log("Play failed:",e)})}ca()}function la(e){aa()}function oa(e){if(Yt)Yt.currentTime(e),ot.value=e;else{const t=et.value;if(!t)return;t.currentTime=e,ot.value=e}}function na(e){if(Yt){const t=Math.max(0,Math.min(Yt.duration(),Yt.currentTime()+e));Yt.currentTime(t),ot.value=t}else{const t=et.value;if(!t)return;const a=Math.max(0,Math.min(t.duration,t.currentTime+e));t.currentTime=a,ot.value=a}}function sa(){if(Yt)Yt.muted(!Yt.muted()),it.value=Yt.muted();else{const e=et.value;if(!e)return;e.muted=!e.muted,it.value=e.muted}}function ia(e){if(Yt)Yt.volume(Math.max(0,Math.min(1,e))),st.value=Yt.volume(),Yt.volume()>0&&(Yt.muted(!1),it.value=!1);else{const t=et.value;if(!t)return;t.volume=Math.max(0,Math.min(1,e)),st.value=t.volume,t.volume>0&&(t.muted=!1,it.value=!1)}}function ra(){document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()}function ua(e){const t=Math.floor(e/3600),a=Math.floor(e%3600/60),l=Math.floor(e%60);return t>0?`${t}:${a.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`:`${a}:${l.toString().padStart(2,"0")}`}function ca(){ut.value=!0,ct.value&&clearTimeout(ct.value),ct.value=setTimeout(()=>{lt.value&&!vt.value&&(ut.value=!1)},3e3)}function va(){ca()}function da(e){const t=et.value,a=e.currentTarget;if(!t||!a)return;const l=a.getBoundingClientRect();oa((e.clientX-l.left)/l.width*t.duration)}function pa(e){if(et.value){switch(e.key){case" ":case"k":e.preventDefault(),aa();break;case"ArrowLeft":e.preventDefault(),na(-10);break;case"ArrowRight":e.preventDefault(),na(10);break;case"ArrowUp":e.preventDefault(),ia(st.value+.1);break;case"ArrowDown":e.preventDefault(),ia(st.value-.1);break;case"m":e.preventDefault(),sa();break;case"f":e.preventDefault(),ra();break;case"e":case"E":e.preventDefault(),yt.value=!yt.value,yt.value&&0===wt.value.length&&!xt.value&&async function(){if(wt.value.length>0)return;const e=`${Ne.value}-${_e.value}-${Ke.value}`,t=function(e){const t=Lt.value[e];return t&&Date.now()-t.timestamp<qe?(t.accessCount++,console.log("📋 Using cached episodes for:",e,`(accessed ${t.accessCount} times)`),t.data):null}(e);if(t){wt.value=t.episodes||[];const e=wt.value.find(e=>e.episode===Be.value);return void(Nt.value=e?.title||qt.value)}xt.value=!0;try{const t=`/api/anime/episodes/${Ne.value}/${_e.value}/${Ke.value}`;console.log("Loading episodes from:",t);const a=await $fetch(t);wt.value=a?.episodes||[],console.log("Loaded episodes:",wt.value);const l=wt.value.find(e=>e.episode===Be.value);Nt.value=l?.title||qt.value,function(e,t){Lt.value[e]={data:t,timestamp:Date.now(),accessCount:1},console.log("💾 Cached episodes for:",e)}(e,a)}catch(a){console.error("Failed to load episodes:",a),wt.value=[],Nt.value=qt.value}finally{xt.value=!1}}();break;case"l":case"L":if(e.preventDefault(),At.value.length>1){const e=(At.value.findIndex(e=>e.code===Ke.value)+1)%At.value.length,t=At.value[e];t&&Fa(t.code)}break;case"Escape":e.preventDefault(),yt.value?yt.value=!1:document.fullscreenElement&&document.exitFullscreen()}ca()}}function ma(){console.log("Video play event - clearing loading state and autoplay error"),lt.value=!0,at.value=!1,tt.value&&tt.value.includes("Cliquez")&&(tt.value=""),ft&&cancelAnimationFrame(ft),gt(),Vt.value&&clearInterval(Vt.value),Vt.value=U(()=>{lt.value&&nt.value>0&&Gt(ot.value,nt.value)},3e4),ca()}function fa(){lt.value=!1,bt(),Vt.value&&(clearInterval(Vt.value),Vt.value=null),nt.value>0&&Gt(ot.value,nt.value),ut.value=!0}function ha(){!function(){const e=et.value;if(!e)return;ft||(ot.value=e.currentTime,e.buffered.length>0&&(dt.value=e.buffered.end(e.buffered.length-1)));!function(){if(!Bt.value||0===Kt.value.length)return;const e=ot.value;let t=!1,a=null;for(const l of Kt.value){const o=l.startTime-e;if(l.endTime,e>=l.startTime&&e<l.endTime){t=!0,a=l.type,console.log(`⏭️ [SKIP] Currently in ${l.type.toUpperCase()} period (${e.toFixed(1)}s of ${l.startTime.toFixed(1)}s-${l.endTime.toFixed(1)}s)`);break}if(o>0&&o<=3){t=!0,a=l.type,console.log(`⏭️ [SKIP] Approaching ${l.type.toUpperCase()} start in ${o.toFixed(1)}s`);break}}t&&!Jt.value?(Jt.value=!0,Ot.value=a,console.log(`⏭️ [SKIP] Showing skip buttons for ${a?.toUpperCase()}`),Ht.value=setTimeout(()=>{console.log("⏭️ [SKIP] Auto-hiding skip buttons (timeout)"),Ea()},1e4)):!t&&Jt.value&&(console.log("⏭️ [SKIP] Hiding skip buttons (no longer in skip period)"),Ea())}()}()}function ga(){Sa()}function ba(){!function(){if(Yt)st.value=Yt.volume(),it.value=Yt.muted();else{const e=et.value;if(!e)return;st.value=e.volume,it.value=e.muted}}()}function ya(){pt.value=!0;const e=et.value;e&&!e.paused?(mt.value=!0,e.pause()):mt.value=!1}function wa(){pt.value=!1;const e=et.value;e&&mt.value&&e.paused&&e.play().catch(e=>{console.log("Auto-resume after seek failed:",e)})}function xa(e){const t=e.target,a=t?.error;tt.value="Erreur de chargement vidéo",at.value=!1,Ma(a,"native")}function ka(){lt.value=!1,ut.value=!0,nt.value>0&&(console.log("🎬 Episode ended, marking as completed"),Gt(nt.value,nt.value))}function $a(){rt.value=!!document.fullscreenElement}function La(e){e&&(e.removeEventListener("play",ma),e.removeEventListener("pause",fa),e.removeEventListener("timeupdate",ha),e.removeEventListener("loadedmetadata",ga),e.removeEventListener("volumechange",ba),e.removeEventListener("seeking",ya),e.removeEventListener("seeked",wa),e.removeEventListener("ended",ka),e.removeEventListener("error",xa))}function Ca(){const e=et.value;e&&(La(e),function(e){e&&(e.addEventListener("play",ma,{passive:!0}),e.addEventListener("pause",fa,{passive:!0}),e.addEventListener("timeupdate",ha,{passive:!0}),e.addEventListener("loadedmetadata",ga,{passive:!0}),e.addEventListener("volumechange",ba,{passive:!0}),e.addEventListener("seeking",ya,{passive:!0}),e.addEventListener("seeked",wa,{passive:!0}),e.addEventListener("ended",ka,{passive:!0}),e.addEventListener("error",xa,{passive:!0}))}(e))}function Sa(){if(Yt)nt.value=Yt.duration(),st.value=Yt.volume(),it.value=Yt.muted(),lt.value=!Yt.paused();else{const e=et.value;if(!e)return;nt.value=e.duration,st.value=e.volume,it.value=e.muted,lt.value=!e.paused}if(Ta(),zt.value&&zt.value.duration>0){const e=zt.value.currentTime,t=Yt?Yt.currentTime():et.value?.currentTime||0;(Oe.value||t<5)&&(console.log("📺 Resuming from saved progress:",e,"seconds",Oe.value?"(continue watching)":"(at start)"),Yt?Yt.currentTime(e):et.value&&(et.value.currentTime=e),ot.value=e,Oe.value&&(Ze.value=`Repris à ${Math.floor(e/60)}:${String(Math.floor(e%60)).padStart(2,"0")}`,setTimeout(()=>{Ze.value=""},3e3),setTimeout(()=>{Yt&&!Yt.playing()?Yt.play().catch(e=>{console.log("Continue watching autoplay failed, user interaction required")}):et.value&&et.value.paused&&et.value.play().catch(e=>{console.log("Continue watching autoplay failed, user interaction required")})},500)))}}async function Ta(){const e=`${Ne.value}-${Be.value}`,t=function(e){const t=Ct.value[e];return t&&Date.now()-t.timestamp<qe?(t.accessCount++,console.log("⏭️ Using cached skip times for:",e,`(accessed ${t.accessCount} times)`),t.data):null}(e);if(t)Kt.value=t.skipTimes||[];else try{console.log("⏭️ [SKIP] Loading skip times for anime:",Ne.value,"episode:",Be.value,"duration:",nt.value);const t=nt.value>0?{episodeLength:nt.value}:{},a=await $fetch(`/api/anime/${Ne.value}/skip/${Be.value}`,{params:t});a?.skipTimes&&Array.isArray(a.skipTimes)?(Kt.value=a.skipTimes,console.log("⏭️ [SKIP] Successfully loaded skip times:",Kt.value.length,"entries"),console.log("⏭️ [SKIP] Skip times details:",Kt.value),function(e,t){Ct.value[e]={data:t,timestamp:Date.now(),accessCount:1},console.log("⏭️ Cached skip times for:",e)}(e,a)):(Kt.value=[],console.log("⏭️ [SKIP] No skip times found for this episode"))}catch(a){console.warn("⏭️ [SKIP] Failed to load skip times:",a),Kt.value=[]}}function Ea(){console.log("⏭️ [SKIP] Hiding skip buttons"),Jt.value=!1,Ot.value=null,Ht.value&&(clearTimeout(Ht.value),Ht.value=null)}let Ua=0,za=0,Va="",Pa=null;async function Ra(){const e=et.value;if(e&&Qe.value){if(Ua>2)return console.error("setupVideo: Too many attempts, giving up"),tt.value="Impossible de charger la vidéo après plusieurs tentatives",void(at.value=!1);Ua++,tt.value="",at.value=!0,lt.value=!1,e.pause(),ta(),e.removeAttribute("src"),e.load(),console.log(`setupVideo: Attempt ${Ua} - Setting up video with URL:`,Qe.value),console.log("setupVideo: Is M3U8:",Zt(Qe.value));try{if(Zt(Qe.value)){const t=await(async()=>{if(C)return C;if(T)return T;if("undefined"!=typeof document&&!document.querySelector("link[data-videojs-preload]")){const e=document.createElement("link");e.rel="preload",e.href="/_nuxt/video-player.js",e.as="script",e.setAttribute("data-videojs-preload","true"),document.head.appendChild(e)}return T=k(()=>import("./DhaPZuqS.js"),__vite__mapDeps([0,1]),import.meta.url).then(async e=>{if(C=e.default,"undefined"!=typeof document){await k(()=>Promise.resolve({}),__vite__mapDeps([2]),import.meta.url);const e="\n        .video-js { width: 100%; height: 100%; }\n        .vjs-loading-spinner { display: none; }\n        .vjs-big-play-button { display: none; }\n      ",t=document.createElement("style");t.textContent=e,document.head.appendChild(t)}return C}),T})();Yt=t(e,{controls:!1,autoplay:!0,muted:!1,preload:"metadata",html5:{hls:{overrideNative:!0,enableLowInitialPlaylist:!0,smoothQualityChange:!0,maxBufferLength:30,maxMaxBufferLength:600,maxBufferSize:6e7,maxBufferHole:.5,maxSeekHole:2,seekHoleNudgeDuration:.1,levelLoadingMaxRetry:4,levelLoadingMaxRetryTimeout:4e3,fragLoadingMaxRetry:6,fragLoadingMaxRetryTimeout:4e3,enableWorker:!0,startLevel:-1,debug:Je.value},nativeAudioTracks:!1,nativeVideoTracks:!1},liveui:!1,responsive:!0,fluid:!0}),Ca(),Yt.on("error",e=>{console.error("Video.js error:",e);const t=Yt.error();t&&(tt.value=`Erreur vidéo: ${t.message||"Unknown error"}`,at.value=!1,Ma(t,"videojs"))}),Yt.on("loadedmetadata",()=>{console.log("Video.js loadedmetadata"),Sa()}),Yt.on("canplay",()=>{console.log("Video.js canplay"),at.value=!1}),Yt.on("waiting",()=>{console.log("Video.js waiting"),at.value=!0}),Yt.on("playing",()=>{console.log("Video.js playing"),at.value=!1}),Yt.src({src:Qe.value,type:"application/x-mpegURL"}),Yt.load(),Yt.play().catch(e=>{console.log("Autoplay prevented by browser, video will start paused"),at.value=!1}),ea=setTimeout(()=>{console.warn("HLS loading timeout, trying next source"),ta(),tt.value="Timeout lors du chargement de la vidéo HLS",at.value=!1,setTimeout(()=>{ja()},500)},1e4)}else{console.log("Using native video element for MP4"),e.src=Qe.value,e.autoplay=!0,Ca();const t=()=>{console.log("Native video canplay"),at.value=!1,e.removeEventListener("canplay",t)},a=()=>{console.log("Native video loadeddata"),at.value=!1,e.removeEventListener("loadeddata",a)},l=t=>{console.error("Native video error:",t),tt.value="Erreur de chargement vidéo",at.value=!1,e.removeEventListener("error",l)};e.addEventListener("canplay",t),e.addEventListener("loadeddata",a),e.addEventListener("error",l),e.play().catch(e=>{console.log("Autoplay prevented by browser, waiting for user interaction"),at.value=!1});const n=setTimeout(()=>{at.value&&(console.warn("Safety timeout: clearing loading state after 10 seconds (native)"),at.value=!1)},1e4);o(()=>{clearTimeout(n),e.removeEventListener("canplay",t),e.removeEventListener("loadeddata",a),e.removeEventListener("error",l)})}}catch(t){console.error("Setup video error:",t);const e=t instanceof Error?t.message:"Unknown error";tt.value=`Erreur lors de la configuration vidéo: ${e}`,at.value=!1}}else console.warn("setupVideo: Missing video element or playUrl")}function Ma(e,t="unknown"){console.error(`Video error (${t}):`,e),Pa&&(clearTimeout(Pa),Pa=null);Va!==t&&(Va=t,za=0);const a=function(e){if(!e)return!1;const t=e.code||e.status||0,a=(e.message||"").toLowerCase();return!!(t>=500||a.includes("network")||a.includes("timeout")||a.includes("connection")||a.includes("fetch"))||!!(a.includes("frag")||a.includes("segment")||a.includes("buffer")||a.includes("manifest"))||!(0!==t&&!a.includes("cors")&&!a.includes("blocked"))}(e);a&&za<2?(za++,console.log(`🔄 Retrying same source (attempt ${za}/2) for recoverable error`),tt.value=`Nouvelle tentative ${za}/2...`,at.value=!0,Pa=setTimeout(()=>{Ra()},2e3*za)):(console.log(`❌ ${a?"Max retries reached":"Non-recoverable error"}, trying next source`),ja())}function ja(){if(Ye.value.length<=1)return void(tt.value="Aucune source alternative disponible");const e=Ge.value;if(Ge.value=(Ge.value+1)%Ye.value.length,Ge.value===e)return console.log("Tried all sources, giving up"),void(tt.value="Toutes les sources vidéo ont échoué");const t=Ye.value[Ge.value];t&&(Ua=0,za=0,Va="",Qe.value=t.proxiedUrl||t.url,tt.value="",at.value=!0,Ra())}async function Aa(){const e=function(e){const t=$t.value[e];return t&&Date.now()-t.timestamp<qe?(t.accessCount++,console.log("📋 Using cached metadata for:",e,`(accessed ${t.accessCount} times)`),t.data):null}(Ne.value);if(e)return Dt.value=e.title||e.name||`Anime ${Ne.value}`,void(e.languageFlags&&(_t.value=e.languageFlags));try{const e=await $fetch(`/api/anime/${Ne.value}`);Dt.value=e?.title||e?.name||`Anime ${Ne.value}`,e?.languageFlags&&(_t.value=e.languageFlags,console.log("Loaded dynamic language flags:",_t.value)),t=Ne.value,a=e,$t.value[t]={data:a,timestamp:Date.now(),accessCount:1},console.log("💾 Cached metadata for:",t)}catch(l){console.error("Failed to load anime metadata:",l),Dt.value=`Anime ${Ne.value}`}var t,a}async function Fa(e){if(e!==Ke.value&&!Mt.value){Mt.value=!0,jt.value=!1;try{console.log(`🔄 Switching from ${Ke.value} to ${e}`),await y({path:`/watch/${Ne.value}/${_e.value}/${e}/${Be.value}`,replace:!0})}catch(t){console.error("Failed to switch language:",t)}finally{Mt.value=!1}}}function Ia(){At.value.length<=1||(jt.value=!jt.value)}function qa(){jt.value=!1}async function Da(e,t=2){for(let l=1;l<=t;l++)try{const t=await $fetch(`/api/anime/episodes/${Ne.value}/${_e.value}/${e}`);return t?.episodes||[]}catch(a){if(console.warn(`Episode fetch attempt ${l}/${t} failed for ${e}:`,a),l===t)throw a;const o=Math.min(500*Math.pow(2,l-1),2e3);await new Promise(e=>setTimeout(e,o))}throw new Error("Max retries exceeded")}async function Na(){We.value=!0,Xe.value="",Ze.value="",Qe.value="",Ye.value=[],Ua=0,za=0,Va="";const e=St(Ne.value,_e.value,Ke.value,Be.value);console.log(`🎬 Resolving episode: ${Ne.value}/${_e.value}/${Ke.value}/${Be.value}`);const t=Tt(e);if(t){console.log("✅ Using cached resolved URLs"),Ye.value=t,Ge.value=0;const e=t.find(e=>"hls"===e.type)||t[0];return Qe.value=e.proxiedUrl||e.url,void(We.value=!1)}try{const t=[Ke.value,"vostfr","vf","va"],l=t.map(e=>Da(e,2).then(t=>({lang:e,episodes:t})).catch(()=>({lang:e,episodes:[]}))),o=await Promise.all(l);o.forEach(({lang:e,episodes:t})=>{Rt.value[e]=t.length>0});const n=o.find(e=>e.lang===Ke.value);let s=n?.episodes.find(e=>Number(e.episode)===Be.value);if(console.log(`🎯 Looking for episode ${Be.value} in ${Ke.value}, found:`,s?`Episode ${s.episode}`:"Not found"),!s){const e=["var","vkr","vcn","vqc","vf1","vf2","vj"].filter(e=>!t.includes(e)).map(e=>Da(e,2).then(t=>({lang:e,episodes:t})).catch(()=>({lang:e,episodes:[]}))),a=await Promise.all(e);a.forEach(({lang:e,episodes:t})=>{Rt.value[e]=t.length>0});for(const{lang:t,episodes:l}of a)if(t!==Ke.value&&l.length>0){if(l.find(e=>Number(e.episode)===Be.value))return console.log(`🔄 Found episode ${Be.value} in ${t}, switching...`),Ze.value=`Langue ${Ke.value.toUpperCase()} indisponible. Basculement en ${t.toUpperCase()}.`,void(await y({path:`/watch/${Ne.value}/${_e.value}/${t}/${Be.value}`,query:{fallback:"1"},replace:!0}))}console.log(`❌ Episode ${Be.value} not found in any available language`)}if(!s)return void(Xe.value=`Épisode ${Be.value.toString().padStart(2,"0")} introuvable pour ${Ke.value.toUpperCase()}`);let i=s?.urls?.length?s.urls:s?.url?[s.url]:[];if(!i.length)return void(Xe.value="Aucun lien pour cet épisode");i=i.sort((e,t)=>{const a=e=>{try{const t=new URL(e).hostname.toLowerCase();return t.includes("sibnet")?10:t.includes("streamtape")?8:t.includes("vidmoly")?7:t.includes("uqload")?5:t.includes("doodstream")?4:t.includes("myvi")?3:t.includes("sendvid")?1:0}catch{return 0}};return a(t)-a(e)}),console.log(`🎯 Sorted ${i.length} candidates by reliability:`,i.map(e=>{try{return`${new URL(e).hostname} (${e})`}catch{return e}}));let r=[],u="";for(let e=0;e<Math.min(i.length,3);e++){const t=i[e];if(t){console.log(`🎯 Trying candidate ${e+1}/${Math.min(i.length,3)}: ${t}`);try{const a=(new TextEncoder).encode(t),l=btoa(String.fromCharCode(...a)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");let o;try{o=new URL(t).origin+"/"}catch{}const n=await $fetch("/api/player/resolve",{params:{u64:l,referer:o,...Je.value?{debug:"1"}:{}},timeout:4e3});if(n?.ok&&n?.urls?.length>0){console.log(`✅ Successfully resolved candidate ${e+1}: ${n.urls.length} URLs found`),r=n.urls;break}{const t=n?.message||"No URLs found";console.warn(`❌ Candidate ${e+1} failed: ${t}`),u=t}}catch(a){const t=a?.message||"Network error";console.warn(`❌ Candidate ${e+1} error: ${t}`),u=t}}}try{const e=await Promise.allSettled(resolvePromises);for(const t of e)if("fulfilled"===t.status&&t.value){r=t.value;break}if(0===r.length){const t=e.filter(e=>"rejected"===e.status).map(e=>e.reason?.message||"Unknown error");u=t.length>0?t.join(", "):"All candidates failed"}}catch(a){u=a?.message||"Parallel resolution failed",console.error("❌ Parallel resolution error:",a)}if(0===r.length)return void(Xe.value=u||"Toutes les sources ont échoué");Ye.value=r,Ge.value=0;const c=r.find(e=>"hls"===e.type)||r[0];Qe.value=c.proxiedUrl||c.url,Et(e,r),Ut()}catch(l){Xe.value=l?.message||"Erreur de résolution"}finally{We.value=!1}}async function _a(){try{const e=Be.value+1;if(Tt(St(Ne.value,_e.value,Ke.value,e)))return void console.log(`🚀 Next episode ${e} already cached`);const t=`/api/anime/episodes/${Ne.value}/${_e.value}/${Ke.value}`,a=await $fetch(t),l=(a?.episodes||[]).find(t=>t.episode===e);if(l&&l.urls&&l.urls.length>0){const t=l.urls[0];console.log(`🚀 Pre-resolving next episode ${e}:`,t),async function(e,t,a,l,o){const n=St(e,t,a,l);if(Tt(n))return;console.log(`🔄 Background resolving episode: ${e}/${t}/${a}/${l}`);const s=o.sort((e,t)=>{const a=e=>{try{const t=new URL(e).hostname.toLowerCase();return t.includes("sibnet")?10:t.includes("streamtape")?8:t.includes("vidmoly")?7:t.includes("uqload")?5:t.includes("doodstream")?4:t.includes("myvi")?3:t.includes("sendvid")?1:0}catch{return 0}};return a(t)-a(e)}).slice(0,3).map(async e=>{if(!e)return null;try{const t=(new TextEncoder).encode(e),a=btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");let l;try{l=new URL(e).origin+"/"}catch{}const o=await $fetch("/api/player/resolve",{params:{u64:a,referer:l},timeout:8e3});if(o?.ok&&o?.urls?.length>0)return o.urls}catch(t){}return null});try{const o=await Promise.allSettled(s);for(const s of o)if("fulfilled"===s.status&&s.value){const o=s.value,i=new Map;for(const e of o)if(!i.has(e.url)){const t=E(e.url);i.set(e.url,{type:"hls"===e.type?"hls":"mp4"===e.type?"mp4":"unknown",url:e.url,proxiedUrl:`/api/proxy?url=${encodeURIComponent(e.url)}&rewrite=1`,quality:e.quality,provider:t?{hostname:t.hostname,reliability:t.reliability,description:t.description}:null})}const r=Array.from(i.values()).sort((e,t)=>{const a=e.provider?.reliability||0;return(t.provider?.reliability||0)-a});r.length>0&&(Et(n,r),Ut(),console.log(`✅ Background resolved episode ${e}/${t}/${a}/${l}: ${r.length} URLs cached`));break}}catch(i){console.debug("Background resolution failed:",i)}}(Ne.value,_e.value,Ke.value,e,l.urls).catch(e=>console.debug("Background preload failed:",e))}}catch(e){console.debug("Failed to preload next episode:",e)}}o(()=>{ta(),bt(),La(et.value),Ka&&(clearTimeout(Ka),Ka=null),Pa&&(clearTimeout(Pa),Pa=null),Ht.value&&(clearTimeout(Ht.value),Ht.value=null),document.removeEventListener("keydown",pa),document.removeEventListener("fullscreenchange",$a),document.removeEventListener("click",qa)}),n([He,Qe],async()=>{He.value?(await i(),Ra()):ta()}),s(async()=>{!function(){try{const e=sessionStorage.getItem("video-url-cache");e&&(kt.value=JSON.parse(e),console.log("📥 Loaded URL cache from sessionStorage"))}catch(e){console.warn("Failed to load URL cache:",e)}}(),await i(),await new Promise(e=>setTimeout(e,100));const[e,t,a]=await Promise.allSettled([Qt().catch(()=>null),Aa().catch(()=>null),Ta().catch(()=>null)]),l=Na();await l,_a().catch(()=>null),await i(),Ca();const n=et.value;n&&(lt.value=!n.paused,ot.value=n.currentTime,nt.value=n.duration||0,st.value=n.volume,it.value=n.muted),document.addEventListener("keydown",pa),document.addEventListener("fullscreenchange",()=>{rt.value=!!document.fullscreenElement}),document.addEventListener("click",qa);const s=()=>{nt.value>0&&Gt(ot.value,nt.value)};window.addEventListener("beforeunload",s),o(()=>{window.removeEventListener("beforeunload",s)})});let Ka=null,Ba="";return n([_e,Ke,Be],()=>{Ka&&clearTimeout(Ka),Ka=setTimeout(()=>{const e=`${Ne.value}-${_e.value}-${Ke.value}-${Be.value}`;e!==Ba&&(Ba=e,Rt.value={vostfr:!1,vf:!1,va:!1,var:!1,vkr:!1,vcn:!1,vqc:!1,vf1:!1,vf2:!1,vj:!1},Na())},100)}),n([Be,wt],()=>{const e=wt.value.find(e=>e.episode===Be.value),t=e?.title||qt.value;t!==Nt.value&&(Nt.value=t)},{immediate:!0}),(e,t)=>{const a=w,l=x;return $(),r("div",{class:"fixed inset-0 bg-black z-50 flex flex-col h-screen overflow-hidden",onMousemove:va},[u("div",{class:m(["absolute top-0 left-0 right-0 z-20 transition-opacity duration-300",ut.value?"opacity-100":"opacity-0"])},[u("div",z,[u("div",V,[u("div",P,[v(l,{to:`/anime/${Ne.value}`,class:"flex items-center gap-2 hover:text-zinc-300 transition-colors"},{default:d(()=>[v(a,{name:"heroicons:arrow-left",class:"w-5 h-5"}),t[12]||(t[12]=u("span",{class:"text-sm font-medium"},"Retour",-1))]),_:1},8,["to"]),t[13]||(t[13]=u("div",{class:"h-5 w-px bg-white/30"},null,-1)),u("div",R,[u("div",M,p(Dt.value||`Anime ${Ne.value}`),1),u("div",j,p(Nt.value||qt.value)+" • "+p(It.value)+" • "+p(Ke.value.toUpperCase()),1)])]),u("div",A,[Ye.value.length>1?($(),r("button",{key:0,onClick:ja,class:"p-2 hover:bg-white/10 rounded-full transition-colors",title:"Source alternative"},[v(a,{name:"heroicons:arrow-path",class:"w-5 h-5"})])):c("",!0)])]),Ze.value?($(),r("div",F,p(Ze.value),1)):c("",!0)])],2),u("div",I,[We.value?($(),r("div",q,[...t[14]||(t[14]=[u("div",{class:"flex flex-col items-center justify-center text-white"},[u("div",{class:"w-16 h-16 border-2 border-white/20 border-t-white rounded-full animate-spin mb-4 mx-auto"}),u("p",{class:"text-lg font-medium text-center"},"Chargement de l'épisode")],-1)])])):Xe.value?($(),r("div",D,[u("div",N,[v(a,{name:"heroicons:exclamation-triangle",class:"w-16 h-16 mx-auto mb-4 text-red-400"}),t[15]||(t[15]=u("h3",{class:"text-xl font-semibold mb-2"},"Impossible de charger l'épisode",-1)),u("p",_,p(Xe.value),1),u("button",{onClick:Na,class:"bg-white text-black px-6 py-3 rounded-lg font-medium hover:bg-zinc-200 transition-colors"}," Réessayer ")])])):($(),r("div",{key:2,class:"w-full h-full relative",onClick:t[11]||(t[11]=e=>yt.value=!1)},[at.value?($(),r("div",K,[...t[16]||(t[16]=[u("div",{class:"flex flex-col items-center justify-center text-white"},[u("div",{class:"w-16 h-16 border-2 border-white/20 border-t-white rounded-full animate-spin mb-4 mx-auto"}),u("p",{class:"text-lg font-medium text-center"},"Chargement de la vidéo")],-1)])])):c("",!0),u("video",{ref_key:"videoRef",ref:et,class:"w-full h-full object-contain cursor-pointer",preload:"metadata",autoplay:"",onClick:la,onDblclick:ra}," Votre navigateur ne supporte pas la lecture vidéo. Veuillez utiliser un navigateur moderne. ",544),yt.value?($(),r("div",{key:1,class:"absolute right-4 bottom-24 w-96 max-h-[32rem] bg-zinc-900/95 backdrop-blur-sm border border-zinc-700 rounded-lg overflow-hidden z-30 shadow-2xl",onClick:t[1]||(t[1]=f(()=>{},["stop"]))},[u("div",B,[u("div",null,[t[17]||(t[17]=u("h3",{class:"text-white font-semibold text-lg"},"Épisodes",-1)),u("p",J,p(It.value)+" • "+p(Ke.value.toUpperCase()),1)]),u("button",{onClick:t[0]||(t[0]=e=>yt.value=!1),class:"text-zinc-400 hover:text-white transition-colors p-1 hover:bg-white/10 rounded"},[v(a,{name:"heroicons:x-mark",class:"w-5 h-5"})])]),u("div",O,[xt.value?($(),r("div",H,[...t[18]||(t[18]=[u("div",{class:"w-8 h-8 border-2 border-zinc-400 border-t-transparent rounded-full animate-spin mx-auto mb-3"},null,-1),u("p",null,"Chargement des épisodes...",-1)])])):0===wt.value.length?($(),r("div",Q,[v(a,{name:"heroicons:exclamation-triangle",class:"w-12 h-12 mx-auto mb-3 text-zinc-500"}),t[19]||(t[19]=u("p",null,"Aucun épisode trouvé",-1))])):($(),r("div",G,[($(!0),r(h,null,g(wt.value,(e,t)=>($(),r("button",{key:e.episode,onClick:t=>{var a;(a=e.episode)!==Be.value&&(yt.value=!1,y({path:`/watch/${Ne.value}/${_e.value}/${Ke.value}/${a}`,replace:!0}))},class:m(["w-full p-4 text-left hover:bg-zinc-800/50 transition-all duration-200 flex items-center gap-4 group relative",e.episode===Be.value?"bg-violet-600/10 border-l-4 border-violet-500":"hover:border-l-4 hover:border-zinc-600"])},[u("div",X,[u("span",Y,p(e.episode.toString().padStart(2,"0")),1),e.episode===Be.value?($(),r("div",Z,[v(a,{name:"heroicons:play-circle",class:"w-6 h-6 text-violet-400"})])):($(),r("div",ee,[v(a,{name:"heroicons:play",class:"w-5 h-5 text-white"})]))]),u("div",te,[u("div",ae,[u("h4",le,p(e.title||`Épisode ${e.episode.toString().padStart(2,"0")}`),1),e.episode===Be.value?($(),r("span",oe," En cours ")):c("",!0)]),u("p",ne,p(e.episode===Be.value?"Vous regardez actuellement cet épisode":e.title?`Épisode ${e.episode.toString().padStart(2,"0")} • ${_e.value}`:`Épisode ${e.episode.toString().padStart(2,"0")} de la saison ${_e.value}`),1)]),u("div",se,[v(a,{name:"heroicons:chevron-right",class:"w-5 h-5 text-zinc-400"})])],10,W))),128))]))])])):c("",!0),u("div",{class:m(["absolute bottom-0 left-0 right-0 transition-opacity duration-300 pointer-events-none z-20",ut.value?"opacity-100":"opacity-0"]),onClick:t[9]||(t[9]=f(()=>{},["stop"]))},[u("div",ie,[u("div",re,[u("div",{class:m(["relative h-1 bg-white/20 rounded-full cursor-pointer hover:h-2 transition-all duration-200",{"opacity-75":pt.value}]),onClick:da,onMouseenter:t[2]||(t[2]=e=>vt.value=!0),onMouseleave:t[3]||(t[3]=e=>vt.value=!1)},[pt.value?($(),r("div",ue,[...t[20]||(t[20]=[u("div",{class:"flex items-center gap-2 text-white text-xs"},[u("div",{class:"w-3 h-3 border border-white/60 border-t-transparent rounded-full animate-spin"}),u("span",null,"Chargement...")],-1)])])):c("",!0),u("div",{class:"absolute top-0 left-0 h-full bg-white/40 rounded-full",style:b({width:Xt.value+"%"})},null,4),u("div",{class:"absolute top-0 left-0 h-full bg-violet-600 rounded-full transition-all duration-100",style:b({width:Wt.value+"%"})},null,4),u("div",{class:"absolute top-1/2 transform -translate-y-1/2 w-3 h-3 bg-violet-600 rounded-full opacity-0 hover:opacity-100 transition-opacity duration-200",style:b({left:Wt.value+"%",marginLeft:"-6px"})},null,4)],34)]),u("div",ce,[u("div",ve,[u("button",{onClick:aa,class:"p-2 hover:bg-white/10 rounded-full transition-colors"},[v(a,{name:lt.value?"heroicons:pause":"heroicons:play",class:"w-6 h-6"},null,8,["name"])]),u("button",{onClick:t[4]||(t[4]=e=>na(-10)),class:"p-2 hover:bg-white/10 rounded-full transition-colors",title:"Reculer 10s"},[v(a,{name:"heroicons:backward",class:"w-5 h-5"})]),u("button",{onClick:t[5]||(t[5]=e=>na(10)),class:"p-2 hover:bg-white/10 rounded-full transition-colors",title:"Avancer 10s"},[v(a,{name:"heroicons:forward",class:"w-5 h-5"})]),u("button",{onClick:sa,class:"p-2 hover:bg-white/10 rounded-full transition-colors"},[v(a,{name:it.value||0===st.value?"heroicons:speaker-x-mark":st.value<.5?"heroicons:speaker":"heroicons:speaker-wave",class:"w-5 h-5"},null,8,["name"])]),u("div",de,[u("div",{class:"h-full bg-violet-600 rounded-full",style:b({width:100*st.value+"%"})},null,4),u("input",{type:"range",min:"0",max:"1",step:"0.1",value:st.value,onInput:t[6]||(t[6]=e=>ia(parseFloat(e.target.value))),class:"absolute inset-0 w-full opacity-0 cursor-pointer"},null,40,pe)]),u("div",me,p(ua(ot.value))+" / "+p(ua(nt.value)),1)]),u("div",fe,[At.value.length>1?($(),r("div",he,[u("button",{onClick:f(Ia,["stop"]),disabled:Mt.value,class:"flex items-center gap-1 px-3 py-1 bg-white/10 hover:bg-white/20 rounded-full transition-colors text-sm font-medium",title:"Changer de langue"},[Mt.value?($(),r("span",be)):($(),r("span",ye,p(Ft.value.label),1)),v(a,{name:"heroicons:chevron-down",class:m(["w-3 h-3 transition-transform",{"rotate-180":jt.value}])},null,8,["class"])],8,ge),jt.value?($(),r("div",{key:0,class:"absolute bottom-full right-0 mb-2 bg-zinc-800 border border-zinc-700 rounded-lg shadow-lg z-50 w-80 overflow-hidden",onClick:t[7]||(t[7]=f(()=>{},["stop"]))},[u("div",we,[($(!0),r(h,null,g(At.value,e=>($(),r("button",{key:e.code,onClick:t=>Fa(e.code),disabled:e.code===Ke.value,class:m(["w-full px-3 py-2 text-left text-sm hover:bg-zinc-700 transition-colors flex items-center gap-2 whitespace-nowrap",{"bg-zinc-700 text-white":e.code===Ke.value,"text-zinc-300":e.code!==Ke.value}])},[u("span",null,p(e.label),1),u("span",ke,p(e.fullLabel),1),e.code===Ke.value?($(),L(a,{key:0,name:"heroicons:check",class:"w-4 h-4 ml-auto"})):c("",!0)],10,xe))),128))])])):c("",!0)])):c("",!0),u("button",{onClick:t[8]||(t[8]=e=>Bt.value=!Bt.value),class:m([Bt.value?"text-violet-400":"text-zinc-400","p-2 hover:bg-white/10 rounded-full transition-colors"]),title:Bt.value?"Désactiver le saut automatique":"Activer le saut automatique"},[v(a,{name:"heroicons:forward",class:"w-5 h-5"})],10,$e),Je.value&&Ye.value.length>1?($(),r("button",Le,[v(a,{name:"heroicons:cog-6-tooth",class:"w-5 h-5"})])):c("",!0),u("button",{onClick:ra,class:"p-2 hover:bg-white/10 rounded-full transition-colors"},[v(a,{name:rt.value?"heroicons:arrows-pointing-in":"heroicons:arrows-pointing-out",class:"w-5 h-5"},null,8,["name"])])])])])],2),tt.value?($(),r("div",Ce,[u("div",Se,[v(a,{name:"heroicons:exclamation-triangle",class:"w-12 h-12 mx-auto mb-3 text-red-400"}),u("h4",Te,p(tt.value),1),u("div",Ee,p(Qe.value),1),u("div",Ue,[u("button",{onClick:Ra,class:"bg-white text-black px-4 py-2 rounded font-medium hover:bg-zinc-200 transition-colors"}," Recharger "),Ye.value.length>1?($(),r("button",{key:0,onClick:ja,class:"bg-zinc-700 text-white px-4 py-2 rounded font-medium hover:bg-zinc-600 transition-colors"}," Source alternative ")):c("",!0)])])])):c("",!0),Je.value&&Ye.value.length?($(),r("div",ze,[t[21]||(t[21]=u("h4",{class:"font-medium mb-2"},"Sources disponibles:",-1)),u("div",Ve,[($(!0),r(h,null,g(Ye.value,(e,t)=>($(),r("div",{key:t,class:m(["flex items-center gap-2 p-2 rounded",e.proxiedUrl===Qe.value?"bg-violet-600/30 border border-violet-500":"bg-zinc-800/50"])},[v(a,{name:"heroicons:play",class:"w-3 h-3 flex-shrink-0"}),u("span",Pe,p(e.type)+" - "+p(e.url),1),e.proxiedUrl!==Qe.value?($(),r("button",{key:0,onClick:t=>function(e){const t=Ye.value.findIndex(t=>t.url===e.url);-1!==t&&(Ge.value=t),Ua=0,za=0,Va="",Qe.value=e.proxiedUrl||e.url,tt.value="",at.value=!0,Ra()}(e),class:"text-xs bg-white text-black px-2 py-1 rounded hover:bg-zinc-200 transition-colors"}," Utiliser ",8,Re)):c("",!0)],2))),128))]),u("div",Me,[u("div",je," Langues disponibles: VOSTFR="+p(Rt.value.vostfr)+", VF="+p(Rt.value.vf)+", VA="+p(Rt.value.va)+", VAR="+p(Rt.value.var)+", VKR="+p(Rt.value.vkr)+", VCN="+p(Rt.value.vcn)+", VQC="+p(Rt.value.vqc)+", VF1="+p(Rt.value.vf1)+", VF2="+p(Rt.value.vf2)+", VJ="+p(Rt.value.vj),1)])])):c("",!0),Jt.value&&Ot.value?($(),r("div",Ae,[u("div",Fe,[u("div",Ie,p("op"===Ot.value?"Générique de début":"Générique de fin"),1),u("button",{onClick:t[10]||(t[10]=e=>function(e){const t=Kt.value.find(t=>t.type===e);t&&et.value?(console.log(`⏭️ [SKIP] Skipping ${e.toUpperCase()} from ${ot.value}s to ${t.endTime}s`),oa(t.endTime),Ea()):console.warn(`⏭️ [SKIP] Could not skip ${e.toUpperCase()} - skip time not found or video not ready`)}(Ot.value)),class:"bg-violet-600 hover:bg-violet-700 text-white px-4 py-2 rounded-lg font-medium transition-colors duration-200 flex items-center gap-2 mx-auto"},[v(a,{name:"heroicons:forward",class:"w-4 h-4"}),t[22]||(t[22]=u("span",null,"Sauter",-1))]),u("button",{onClick:Ea,class:"text-xs text-zinc-400 hover:text-zinc-300 mt-2 block mx-auto transition-colors"}," Masquer ")])])):c("",!0)]))])],32)}}}),[["__scopeId","data-v-cc3ad26b"]]);export{De as default};
